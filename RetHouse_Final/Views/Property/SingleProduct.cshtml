@model Category
@inject ICloudinaryService _CloudinaryService
@{
    ViewData["Title"] = "SingleProduct";
}


@foreach (var item in Model.Agents)
{
    if (item.Id == ViewBag.AgentId)
    {
        @foreach (var prop in item.Properties)
        {
            if (prop.Id == ViewBag.PropId)
            {

                <!-- BREADCRUMB -->
                <div class="bg-theme-overlay">
                    <section class="section__breadcrumb ">
                        <div class="container">
                            <div class="row d-flex justify-content-center">
                                <div class="col-md-8 text-center">
                                    <h2 class="text-capitalize text-white ">@prop.Name</h2>
                                    <ul class="list-inline ">
                                        <li class="list-inline-item">
                                            <a asp-controller="home" asp-action="index" class="text-white">
                                                ana səhifə
                                            </a>
                                        </li>
                                        <li class="list-inline-item">
                                            <a asp-controller="agency" asp-action="index" class="text-white">
                                                mülklər
                                            </a>
                                        </li>

                                    </ul>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <!-- END BREADCRUMB -->
                <!-- SINGLE DETAIL -->



                <section class="single__Detail">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-8">
                                <!-- SLIDER IMAGE DETAIL -->
                                <div class="slider__image__detail-large owl-carousel owl-theme">
                                    @foreach (var img in prop.PropImages)
                                    {
                                        <div class="item">
                                            <div class="slider__image__detail-large-one">
                                                <img src="@_CloudinaryService.BuildUrl(img.Photo)" alt="" class="img-fluid w-100 img-transition">
                                                <div class="description">
                                                    <figure>
                                                        <img src="images/profile-blog.jpg" alt="" class="img-fluid">
                                                    </figure>
                                                    <span class="badge badge-primary text-capitalize mb-2">@Model.Name</span>
                                                    <div class="price">
                                                        @if (prop.PropStatus == Repository.Enums.PropStatus.Satılır)
                                                        {
                                                            <h5 class="text-capitalize">@prop.Price ₼ </h5>
                                                        }
                                                        else
                                                        {
                                                            <h5 class="text-capitalize">@prop.Price ₼ /ayliq</h5>
                                                        }

                                                    </div>
                                                    <h4 class="text-capitalize">@prop.Name</h4>

                                                </div>

                                            </div>
                                        </div>
                                    }

                                </div>

                                <div class="slider__image__detail-thumb owl-carousel owl-theme">
                                    @foreach (var img in prop.PropImages)
                                    {
                                        <div class="item">
                                            <div class="slider__image__detail-thumb-one">
                                                <img src="@_CloudinaryService.BuildUrl(img.Photo)" alt="" class="img-fluid w-100 img-transition">
                                            </div>
                                        </div>
                                    }

                                </div>
                                <!-- END SLIDER IMAGE DETAIL -->
                                <div class="row">
                                    <div class="col-md-9 col-lg-9">
                                        <div class="single__detail-title mt-4">
                                            <h3 class="text-capitalize">@prop.Name</h3>
                                            <p> @prop.Adress</p>
                                        </div>
                                    </div>
                                    <div class="col-md-3 col-lg-3">
                                        <div class="single__detail-price mt-4">

                                            @if (prop.PropStatus == Repository.Enums.PropStatus.Satılır)
                                            {
                                                <h5 class="text-capitalize">@prop.Price ₼ </h5>
                                            }
                                            else
                                            {
                                                <h5 class="text-capitalize">@prop.Price ₼ /ayliq</h5>
                                            }
                                            <ul class="list-inline">
                                                <li class="list-inline-item">
                                                    <a href="#" class="badge badge-primary p-2 rounded">
                                                        <i class="fa fa-print"></i>
                                                    </a>
                                                </li>
                                                <li class="list-inline-item">
                                                    <a href="#" class="badge badge-primary p-2 rounded">
                                                        <i class="fa fa-exchange"></i>
                                                    </a>
                                                </li>

                                                <li class="list-inline-item">
                                                    <a href="#" class="badge badge-primary p-2 rounded">
                                                        <i class="fa fa-heart"></i>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>

                                    </div>
                                </div>
                                <!-- DESCRIPTION -->
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="single__detail-desc">
                                            <h6 class="text-capitalize detail-heading">Haqqında</h6>
                                            <div class="show__more">
                                                @Html.Raw(prop.Description)
                                                <a href="javascript:void(0)" class="show__more-button ">daha ətraflı</a>
                                            </div>
                                        </div>
                                        <div class="clearfix"></div>

                                        <!-- PROPERTY DETAILS SPEC -->
                                        <div class="single__detail-features">
                                            <h6 class="text-capitalize detail-heading">Göstəricilər</h6>
                                            <!-- INFO PROPERTY DETAIL -->
                                            <div class="property__detail-info">
                                                <div class="row">
                                                    <div class="col-md-6 col-lg-6">
                                                        <ul class="property__detail-info-list list-unstyled">
                                                            @{ var i = 0;}
                                                            @foreach (var det in prop.PropDetails)
                                                            {
                                                                i++;
                                                                <li><b>@det.Key</b> @det.Value</li>
                                                                if (i == 5)
                                                                {
                                                                    break;
                                                                }
                                                            }

                                                        </ul>
                                                    </div>
                                                    <div class="col-md-6 col-lg-6">
                                                        <ul class="property__detail-info-list list-unstyled">
                                                            @{ i = 0;}
                                                            @foreach (var det in prop.PropDetails)
                                                            {
                                                                i++;
                                                                if (i < 6)
                                                                {
                                                                    continue;
                                                                }

                                                                <li><b>@det.Key</b> @det.Value</li>

                                                            }

                                                        </ul>
                                                    </div>
                                                </div>

                                            </div>
                                            <!-- END INFO PROPERTY DETAIL -->
                                        </div>
                                        <!-- END PROPERTY DETAILS SPEC -->
                                        <div class="clearfix"></div>

                                        <!-- FEATURES -->
                                        <div class="single__detail-features">
                                            <h6 class="text-capitalize detail-heading">features</h6>
                                            <ul class="list-unstyled icon-checkbox">
                                                @foreach (var feature in prop.PropFeatures)
                                                {
                                                    if (feature.Value)
                                                    {
                                                        <li>@feature.Key</li>
                                                    }

                                                }

                                            </ul>
                                        </div>
                                        <!-- END FEATURES -->
                                        <!-- FLOR PLAN -->
                                        <div class="single__detail-features">
                                            <h6 class="text-capitalize detail-heading">floor plan</h6>
                                            <!-- FLOR PLAN IMAGE -->
                                            <div id="accordion" class="floorplan" role="tablist">
                                                @{var a = 0;
                                                    var b = "headingOne";
                                                    var c = "collapseOne";
                                                }
                                                @foreach (var floor in prop.PropFloors)
                                                {
                                                    a++;
                                                    if (a != 1)
                                                    {
                                                        if (a == 2)
                                                        {
                                                            b = "headingTwo";
                                                            c = "collapseTwo";
                                                        }
                                                        else
                                                        {
                                                            b = "headingThree";
                                                            c = "collapseThree";
                                                        }

                                                    }
                                                    <div class="card">
                                                        <div class="card-header" role="tab" id="@b">
                                                            <a class="collapsed text-capitalize" data-toggle="collapse" href="#@c"
                                                               aria-expanded="true" aria-controls="@c">
                                                                @floor.Name <span class="badge badge-light rounded p-1 ml-2">
                                                                    @floor.Area
                                                                </span>
                                                            </a>
                                                        </div>
                                                        <div id="@c" class="collapse" role="tabpanel"
                                                             aria-labelledby="headingOne" data-parent="#accordion">
                                                            <div class="card-body">
                                                                <figure>
                                                                    <img src="@_CloudinaryService.BuildUrl(floor.Photo)" alt="" class="img-fluid">
                                                                </figure>

                                                            </div>
                                                        </div>
                                                    </div>
                                                }


                                            </div>
                                        </div>
                                        <!-- END FLOR PLAN -->
                                        <div class="single__detail-features">
                                            <h6 class="text-capitalize detail-heading">Əmlak videosu</h6>
                                            <div class="single__detail-features-video">
                                                <figure class=" mb-0">
                                                    <div class="home__video-area text-center">
                                                        <img src="~/images/bg13.jpg" alt="" class="img-fluid">
                                                        <a href="https://youtu.be/dQtLx6dsbcI" class="play-video-1 ">
                                                            <i class="icon fa fa-play text-white"></i>
                                                        </a>
                                                    </div>

                                                </figure>
                                            </div>
                                        </div>

                                        <!-- LOCATION -->
                                        <div class="single__detail-features">
                                            <h6 class="text-capitalize detail-heading">Ünvan</h6>
                                            <!-- FILTER VERTICAL -->
                                            <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                                                <li class="nav-item">
                                                    <a class="nav-link active" id="pills-map-location-tab" data-toggle="pill"
                                                       href="#pills-map-location" role="tab" aria-controls="pills-map-location"
                                                       aria-selected="true">
                                                        <i class="fa fa-map-marker"></i>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" id="pills-street-view-tab" data-toggle="pill"
                                                       href="#pills-street-view" role="tab" aria-controls="pills-street-view"
                                                       aria-selected="false">
                                                        <i class="fa fa-street-view "></i>
                                                    </a>
                                                </li>


                                            </ul>
                                            <div class="tab-content" id="pills-tabContent">
                                                <div class="tab-pane fade show active" id="pills-map-location" role="tabpanel"
                                                     aria-labelledby="pills-map-location-tab">
                                                    <div id="map-canvas">
                                                        <iframe class="h600 w100"
                                                                src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d50446.89789906054!2d-122.41577600000001!3d37.791654!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0xd473843de08ff793!2sBetter%20Property%20Management!5e0!3m2!1sen!2sus!4v1591226304089!5m2!1sen!2sus"
                                                                style="border:0;" allowfullscreen="" aria-hidden="false"
                                                                tabindex="0"></iframe>
                                                    </div>

                                                </div>
                                                <div class="tab-pane fade" id="pills-street-view" role="tabpanel"
                                                     aria-labelledby="pills-street-view-tab">
                                                    <iframe class="h600 w100"
                                                            src="https://www.google.com/maps/embed?pb=!4v1553797194458!6m8!1m7!1sR4K_5Z2wRHTk9el8KLTh9Q!2m2!1d36.82551718071267!2d-76.34864590837246!3f305.15097!4f0!5f0.7820865974627469"
                                                            style="border:0;" allowfullscreen></iframe>
                                                </div>


                                            </div>
                                            <!-- END FILTER VERTICAL -->
                                        </div>
                                        <!-- END LOCATION -->
                                        <!-- RATE US  WRITE -->
                                        <div class="single__detail-features">
                                            <h6 class="text-capitalize detail-heading">Şərh yaz</h6>
                                            <div class="single__detail-features-review">
                                                @foreach (var review in prop.Reviews)
                                                {
                                                    <div class="media mt-4">
                                                        <img class="mr-3 img-fluid rounded-circle" src="~/images/profile-blog.jpg" alt="">
                                                        <div class="media-body">
                                                            <h6 class="mt-0">@review.Name</h6>
                                                            <span class="mb-3">@review.CreatedAt.ToString("yyyy-MM-dd")</span>
                                                            <ul class="list-inline">
                                                                <li class="list-inline-item">
                                                                    @for (int z = 0; z < review.Star; z++)
                                                                    {
                                                                        <i class="fa fa-star selected"></i>
                                                                    }

                                                                    @for (int z = review.Star; z < 5; z++)
                                                                    {
                                                                        <i class="fa fa-star"></i>
                                                                    }

                                                                </li>
                                                                <li class="list-inline-item">@review.Star/5</li>
                                                            </ul>
                                                            <p>
                                                                @review.Comment
                                                            </p>
                                                        </div>
                                                    </div>
                                                }

                                                <!-- COMMENT -->
                                                @{ Model.Name = "";
                                                    Model.CreatedBy = "";
                                                    }
                                                <hr>
                                                <form method="post">
                                                    <input asp-for="catId" value="@Model.Id" type="hidden" />
                                                    <input asp-for="othrId" value="@item.Id" type="hidden" />
                                                    <input asp-for="ModifiedBy" value="@prop.Id" type="hidden" />
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <p class="mb-2">Reytinqiniz:</p>
                                                            <select asp-for="Id">
                                                                <option>1</option>
                                                                <option>2</option>
                                                                <option>3</option>
                                                                <option>4</option>
                                                                <option>5</option>
                                                            </select>
                                                            <span class="field-validation-valid text-danger" asp-validation-for="Id"></span>
                                                            <div class="form-group mt-2">
                                                                <label>Sizin adınız</label>
                                                                <input type="text" class="form-control" required="required" asp-for="CreatedBy">
                                                                <span class="field-validation-valid text-danger" asp-validation-for="CreatedBy"></span>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12">
                                                            <div class="form-group">
                                                                <label>Mesajınız</label>
                                                                <textarea class="form-control" rows="4" asp-for="Name"></textarea>
                                                                <span class="field-validation-valid text-danger" asp-validation-for="Name"></span>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <button type="submit" class="btn btn-primary float-right ">
                                                        Göndər <i class="fa fa-paper-plane ml-2"></i>
                                                    </button>
                                                    <!-- END COMMENT -->
                                                </form>

                                            </div>
                                        </div>
                                        <!-- END RATE US  WRITE -->
                                    </div>
                                </div>
                                <!-- END DESCRIPTION -->
                            </div>
                            <div class="col-lg-4">
                                <!-- FORM FILTER -->
                                <div class="products__filter mb-30">
                                    <div class="products__filter__group">
                                        <div class="products__filter__header">

                                            <h5 class="text-center text-capitalize">kalkulyator </h5>
                                        </div>
                                        <div class="products__filter__body">
                                            <div class="form-group">
                                                <label>Satış qiyməti</label>

                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">₼</span>

                                                    </div>
                                                    <input id="calcPrise" type="number" class="form-control" placeholder="130.000 ₼">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label>İlkin ödəniş</label>
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">₼</span>
                                                    </div>
                                                    <input id="calcFirst" type="number" class="form-control" placeholder="6.000 ₼">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label>Neçə il</label>
                                                <select id="calcYear" class="select_option wide">

                                                    <option value="10">10</option>
                                                    <option value="15">15</option>
                                                    <option value="20">20</option>
                                                    <option value="25">25</option>
                                                </select>

                                            </div>

                                            <div class="form-group">
                                                <label>Faiz dərəcəsi</label>

                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">%</span>

                                                    </div>
                                                    <input id="calcPers" type="number" class="form-control" max="100" min="0" placeholder="10%">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label>Nəticə / Ödəniş</label>

                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">Aylıq:</span>

                                                    </div>
                                                    <input id="calcResult" type="text" class="form-control" readonly>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="products__filter__footer">
                                            <div class="form-group mb-0">
                                                <button id="calcBtn" class="btn btn-primary text-capitalize btn-block">
                                                    hesabla
                                                    <i class="fa fa-calculator ml-1"></i>
                                                </button>

                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- END FORM FILTER -->
                                <div class="sticky-top">
                                    <!-- PROFILE AGENT -->
                                    <div class="profile__agent mb-30">
                                        <div class="profile__agent__group">

                                            <div class="profile__agent__header">
                                                <div class="profile__agent__header-avatar">
                                                    <figure>
                                                        <img src="~/images/profile-blog.jpg" alt="" class="img-fluid">
                                                    </figure>
                                                   
                                                    <ul class="list-unstyled mb-0">
                                                        <li>
                                                            <h5 class="text-capitalize">@item.Name</h5>
                                                        </li>
                                                        <li>
                                                            <a href="tel:123456">
                                                                <i class="fa fa-phone-square mr-1"></i>@item.MobilePhone
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a href="javascript:void(0)">
                                                                <i class=" fa fa-building mr-1"></i>
                                                                @item.Agency.Name
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a asp-controller="agent" asp-action="singleagent" asp-route-id="@Model.Id" asp-route-agentId="@item.Id" class="text-primary">Əmlaklarına bax</a>
                                                        </li>
                                                    </ul>


                                                </div>

                                            </div>
                                            <form method="post">



                                                <div class="profile__agent__body">
                                                    <input type="hidden" value="9999" asp-for="Id" />
                                                    <input type="hidden" value="@item.Email" asp-for="ModifiedBy"/>
                                                    <div class="form-group">
                                                        <input type="text" required asp-for="Name" class="form-control" placeholder="Adınız">
                                                    </div>
                                                    <div class="form-group">
                                                        <input type="text" required asp-for="othrId" class="form-control" placeholder="Telefon nömrəniz XX-XXX-XX-XX">
                                                    </div>
                                                    <div class="form-group mb-0">
                                                        <textarea  asp-for="CreatedBy" class="form-control required" rows="5" required="required"
                                                                  placeholder="Sizi maraqlandıran mövzu"></textarea>
                                                    </div>
                                                </div>
                                            <div class="profile__agent__footer">
                                                <div class="form-group mb-0">
                                                    <button type="submit" class="btn btn-primary text-capitalize btn-block">
                                                        mesajı göndər <i class="fa fa-paper-plane ml-1"></i>
                                                    </button>

                                                </div>
                                            </div>

                                            </form>
                                        </div>

                                    </div>
                                    <!-- END PROFILE AGENT -->
                                </div>
                            </div>
                        </div>

                        <!-- SIMILIAR PROPERTY -->
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="similiar__item">
                                    <h6 class="text-capitalize detail-heading">
                                        Oxşar mülklər
                                    </h6>
                                    <div class="similiar__property-carousel owl-carousel owl-theme">
                                        @foreach (var agent in Model.Agents)
                                        {

                                            if (agent.Id == ViewBag.AgentId)
                                            {
                                                @foreach (var props in item.Properties)
                                                {

                                                    @if (prop.IsFeatured)
                                                    {
                                                        c = "Önə çıxan";
                                                    }
                                                    else
                                                    {
                                                        if (prop.PropStatus == Repository.Enums.PropStatus.Satılır)
                                                        {
                                                            c = "Satılıb";
                                                        }
                                                    }

                                                    <div class="item">
                                                        <!-- ONE -->
                                                        <div class="card__image">
                                                            <div class="card__image-header h-250">
                                                                <div class="ribbon text-capitalize">@c</div>
                                                                @foreach (var img in props.PropImages)
	                                                            {
                                                            <img src="@_CloudinaryService.BuildUrl(img.Photo)" alt="" class="img-fluid w100 img-transition">
                                                                    break;
                                                                }
                                                                
                                                                <div class="info"> @prop.PropStatus</div>
                                                            </div>
                                                            <div class="card__image-body">
                                                                <span class="badge badge-primary text-capitalize mb-2">@Model.Name</span>
                                                                <h6 class="text-capitalize">
                                                                    <a asp-controller="property" asp-action="SingleProduct" asp-route-id="@Model.Id" asp-route-agentId="@agent.Id" asp-route-propId="@props.Id">@props.Name</a>
                                                                </h6>

                                                                <p class="text-capitalize">
                                                                    <i class="fa fa-map-marker"></i>
                                                                    @props.Adress
                                                                </p>
                                                                <ul class="list-inline card__content">
                                                                    <li class="list-inline-item">

                                                                        <span>
                                                                            Hamam <br>
                                                                            <i class="fa fa-bath"></i> @props.BathCount
                                                                        </span>
                                                                    </li>
                                                                    <li class="list-inline-item">
                                                                        <span>
                                                                            Yataq otaqı <br>
                                                                            <i class="fa fa-bed"></i> @props.BedCount
                                                                        </span>
                                                                    </li>
                                                                    <li class="list-inline-item">
                                                                        <span>
                                                                            otaqlar <br>
                                                                            <i class="fa fa-inbox"></i> @props.RoomCount
                                                                        </span>
                                                                    </li>
                                                                    <li class="list-inline-item">
                                                                        <span>
                                                                            sahə <br>
                                                                            <i class="fa fa-map"></i> @props.Area
                                                                        </span>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                            <div class="card__image-footer">
                                                                <figure>
                                                                    <img src="~/images/profile-blog.jpg" alt="" class="img-fluid rounded-circle">
                                                                </figure>
                                                                <ul class="list-inline my-auto">
                                                                    <li class="list-inline-item">
                                                                        <a href="#">
                                                                            @agent.Name <br>
                                                                        </a>

                                                                    </li>

                                                                </ul>
                                                                <ul class="list-inline my-auto ml-auto">
                                                                    <li class="list-inline-item">
                                                                        @if (props.PropStatus == Repository.Enums.PropStatus.Satılır)
                                                                        {
                                                                        <h6 class="text-primary">@props.Price ₼</h6>
                                                                        }
                                                                        else
                                                                        {
                                                                    <h6 class="text-primary">@props.Price ₼ /aylıq</h6>
                                                                        }

                                                                    </li>

                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>

                                                }


                                            }
                                        }

                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- END SIMILIAR PROPERTY -->
                    </div>
                </section>

            }


        }


    }

}

<!-- END SINGLE DETAIL -->

@section Head{
    <!-- SPECIFIC CSS -->
    <link href="~/css/stylesbd04.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
}
@section Scripts{
    <script>
        window.onload = function () {
        var price = document.getElementById("calcPrise")
        var calcFirst = document.getElementById("calcFirst")
        var calcYear = document.getElementById("calcYear")
        var calcPers = document.getElementById("calcPers")
        var calcBtn = document.getElementById("calcBtn");
        var calcResult = document.getElementById("calcResult")
            calcBtn.addEventListener("click", function () {
                console.log(price.value > 0)
                if (price.value > 0 || calcFirst.value > 0 || calcPers.value > 0) {
                    var a = ((parseInt(price.value) + (parseInt(price.value) * parseInt(calcPers.value)) / 100) / parseInt(calcYear.value)) / 12;
                    console.log((price.value + (price.value * calcPers.value) / 100))

                    calcResult.value = a.toFixed(2) + " ₼";
                   
                } else {
                    calcResult.style.color = "red";
                    calcResult.value = "Xahiş olunur Dataları doldurun !!"
                    return
                }
           
        })
            }
    </script>

}